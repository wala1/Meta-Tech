{% extends "base.html.twig" %}

{% block body %}

<div class="main-content">

        <div class="page-content">
                <div class="container-fluid">
                        <section>
                                {% for publication in publications %}
                                <publication id="descripForm">
                                        <h2>{{ publication.titrePubl }}</h2>
                                        <div class="metadata">Ecrit le {{ publication.tempsPubl | date }}
                                                dans la categorie </div>
                                        <div class="content">
                                                <img src="{{ publication.imagepubl }}" width="300px" alt="">
                                                <p>
                                                        {{ publication.descriptionPubl }}
                                                </p>
                                                {% if app.user == publication.utilisateur %}
                                                <div class="row">
                                                        <a href=" {{ path('delete_publ', {'id' : publication.id }) }} "
                                                                class="btn btn-sm btn-outline-secondery"
                                                                onclick="return confirm ('attention ce ci va supprimer ')">Supprimer</a>
                                                        <a href=" {{ path('modifier_blog', {'id' : publication.id }) }} "
                                                                class="btn btn-primary">modifier</a>
                                                </div>
                                                {% endif %}
                                                <br>
                                                {% for commentaire in publication.commentaires %}
                                                <div id="descripbr" class="col-6">
                                                        <p> {{ commentaire.descriptionComm}} <i> by {{
                                                                        commentaire.utilisateur.username}} at
                                                                        {{commentaire.tempsComm |
                                                                        date }} </i>
                                                                {% if app.user == commentaire.utilisateur %}
                                                                <a href="#descripbr"
                                                                        onclick="onClickModifier({{ commentaire.id}} , '{{commentaire.descriptionComm }}')">
                                                                        modifier </a> <a
                                                                        href="{{ path('supprrimer_commentaire_blog', {'idPublication' : publication.id, 'id' : commentaire.id }) }}">
                                                                        supprimer </a>
                                                                {% endif %}
                                                        </p>
                                                </div>
                                                {% endfor %}
                                                <br>
                                                {% if app.user %}
                                                <form method="post" class="row"
                                                        action="{{ path('commenter_blog', {'id' : publication.id }) }}">
                                                        <div class="col-8">
                                                                <input id="descrip" type="text" name="description" />
                                                        </div>
                                                        <div class="col-2">
                                                                <button type="submit" value="ajouter">commenter</button>
                                                        </div>
                                                        <div class="col-8">
                                                                <input id="idCommentaire" type="text"
                                                                        name="idCommentaire" hidden />
                                                        </div>
                                                </form>
                                                {% endif %}
                                        </div>
                                </publication>
                                {% endfor %}
                        </section>
                </div>
        </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
        function onClickModifier(id, desc) {
                document.getElementById('descrip').setAttribute("value", desc);
                document.getElementById('idCommentaire').setAttribute("value", id);
        }
</script>
{% endblock %}